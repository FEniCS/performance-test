<head>
<!-- Load plotly.js into the DOM -->
<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
</head>

<body>

  <H1> Performance Test </H1>
    <div id='PoissonDiv'></div>
    <div id='ElasticDiv'></div>

    <script>

var layout_e = {
    barmode: 'group',
    title: {text: 'Solve time (Elastic)'},
    xaxis: {title: {text: 'Nodes'}},
    yaxis: {title: {text: 'time (s)'}}
};
var layout_p = {
    barmode: 'group',
    title: {text: 'Solve time (Poisson)'},
    xaxis: {title: {text: 'Nodes'}},
    yaxis: {title: {text: 'time (s)'}}
};

var traces = {poisson:[],
	      elastic:[]};


fetch('https://raw.githubusercontent.com/js947/fenics-performance-results/master/results.json')
    .then((response) => {
	return response.json();
    })
    .then((myJson) => {
	for (var key in myJson){
	    var record = myJson[key];
	    console.log(record.data);
	    console.log(record.time);
	    var ptrace = {x: [],
			  y: [],
			  type: 'bar',
			  name: record.time};
	    var etrace = {x: [],
			  y: [],
			  type: 'bar',
			  name: record.time};
	    for (var r in record.data){
		w = record.data[r];
		if (w.problem == "Poisson"){
		    // console.log(w.Solve);
		    ptrace.y.push(w.Solve);
		    // console.log(w.nodes);
		    ptrace.x.push(w.nodes);
		}
		if (w.problem == "Elastic"){
		    console.log(w.Solve);
		    etrace.y.push(w.Solve);
		    console.log(w.nodes);
		    etrace.x.push(w.nodes);
		}
	    }
	    traces.poisson.push(ptrace);
	    traces.elastic.push(etrace);
	}
	Plotly.newPlot('PoissonDiv', traces.poisson, layout_p);
	Plotly.newPlot('ElasticDiv', traces.elastic, layout_e);
    });


console.log(traces);


</script>
</body>
